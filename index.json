



















[{"categories":null,"contents":"1. 분석 개요 대상 정보 구분 정보 파일명 정부24.apk 패키지명 com.efimoongar 앱 분류 Trojan-Spyware MD5 Hash fc4c8ad2a4ee15575c2bd05d77f7bd5b 수집 경로 KISA [표 1] 대상 정보\n타 백신 검사 결과 바이러스토탈(www.virustotal.com)에서 타 백신 검사 결과를 확인한 결과, 검색되지 않는 것을 확인했다.\n","date":"09 Oct, 2024","image":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003cpicture\u003e\n  \u003csource srcset=\"/images/article03/main_new_hu3246314836548743943.webp\" media=\"(max-width: 575px)\"\u003e\n  \u003csource srcset=\"/images/article03/main_new_hu8743943782282367533.webp\" media=\"(max-width: 767px)\"\u003e\n  \u003csource srcset=\"/images/article03/main_new_hu781100524863977467.webp\" media=\"(max-width: 991px)\"\u003e\n  \u003csource srcset=\"/images/article03/main_new_hu6438237009245508364.webp\"\u003e\n  \u003cimg loading=\"lazy\" decoding=\"async\" class=\"w-100 img-fluid rounded\" src=\"/images/article03/main_new_hu16268680320737556984.jpg\" alt=\"\" width=\"1000\" height=\"800\"\u003e\n\u003c/picture\u003e\n \n \n \n\n","permalink":"https://dodaeche.github.io/blog/article03/article/","tags":["Malware","APK","정부24"],"title":"악성 앱 정부24 분석 결과"},{"categories":null,"contents":"최근 유명인을 사칭하거나 공모주를 저렴한 가격으로 배정이 가능하다며 허위 주식거래 앱(MTS, Mobile Trading System) 설치를 유도하는 금융투자 사기가 성행하고 있다. 이들은 금융투자업체를 사칭한 사이트를 만들고 임명장이나 증명서 등을 위조하여 사용자들의 신뢰를 얻는다. 허위 MTS 앱은 조작된 정보를 보여주며 투자 및 거래를 유도하지만 실제로 거래가 이루어지진 않는다. 또한 증거금 명목이나 출금 수수료 등 추가 요금을 요구하기도 한다. 이들은 SMS뿐만 아니라 카카오톡 오픈 채팅방, 네이버 밴드, 텔레그램과 같은 SNS를 활용해 사용자를 모집한다. 이에 본 리포트에서는 조작된 정보를 제공하여 투자금을 편취하는 허위MTS 앱 ‘울림’과 이러한 앱이 유포되는 금융투자업체 사칭 사이트의 특징을 분석한다.\n금융투자업체 사칭 사이트 특징 이들은 금융투자업체를 사칭한 피싱 사이트로 사용자들을 유인하고 해당 사이트에서 MTS 앱을 다운로드 하도록 유도하여 사용자들의 경계심을 낮춘다. 하지만 이러한 사이트들은 회사 위치, 사업자 등록번호와 같은 회사 정보를 제공하지 않는 경우가 많다. 또한 그림 1, 그림 2와 같이 회원가입 시 반드시 고지해야 할 가입약관, 개인정보처리방침 등의 내용이 비어있거나 오타가 존재하는 경우도 있다. 회원가입의 경우 반드시 추천인이 필요하거나 사전에 문자 메시지를 받은 번호만 가입이 가능하며 최종적으로 운영자의 승인이 필요한 폐쇄적인 회원가입 과정을 가지고 있다. 마지막으로 우리나라의 금융투자업체는 반드시 금융위원회에 등록해야 하지만 사칭 사이트에서 보여지는 업체는 등록을 하지 않아 금융감독원 소비자정보 포털 파인 )에서 조회되지 않는다.\n[그림 1] 입력되지 않은 개인정보처리방침 및 회원가입약관\n[그림 2] 개인정보 수집 및 이용 동의서의 잘못된 띄어쓰기\n허위 MTS 앱 허위 MTS 앱의 목적은 조작된 정보를 제공하여 투자를 유도한 뒤 투자금을 편취하는 것이다. 따라서 사용자가 거래를 시도하면 화면에 표시되는 수치만 바뀔 뿐 실제로 체결되진 않으며 조작된 정보는 별도의 서버를 통해서 받아온다. 분석 대상 앱의 경우 그림 3과 같은 과정을 통해 블로그 게시물의 암호화된 문자열(그림 4)을 복호화 하여 통신할 서버 정보를 얻는다.\n[그림 3] 허위 MTS 앱 통신 흐름\n[그림 4] 블로그에 암호화되어 게시된 허위 MTS 앱의 통신 주소\n블로그 게시물의 암호화된 문자열은 base64 및 DES알고리즘(CBC 모드)을 사용하여 복호화 된다. 그림 6은 암호화된 문자열을 복호화 한 결과의 일부로 MTS앱 명, 업체 명, 서버 주소, 포트 순으로 70여 개의 허위 MTS 앱 및 업체 정보가 나열되어 있다.\n[그림 5] 암호화된 문자열의 복호화 처리 코드\n[그림 6] 암호화된 블로그 게시물의 복호화 결과 예시\n그림 7은 분석 대상 앱 ‘울림’이 해당하는 메인 서버(dhehdals[.]cfuser-40289.kr – 172[.]65.178.250)와 통신한 패킷이며 암호화 프로토콜인 TLS가 적용되어 있다.\n[그림 7] 메인 서버(dhehdals.cfuser-40289.kr - 172.65.178.250) 통신 패킷\n[그림 8] Transport Layer Security(TLS) 적용 코드\n그림 9는 로그인 시 발생하는 TLS 패킷을 해독한 것으로 입력 값인 testid, testpw123가 전송되었음을 확인할 수 있다. 다만, 가입 승인이 되지 않아 로그인 이후의 패킷 확인은 불가능하다. 이러한 통신 패킷을 암호화하는 행위는 악성 앱이 안티 바이러스 제품의 탐지를 회피하기 위해 사용하는 방법이기도 하지만 전자금융거래 시 암호화 통신이 필수사항이기에 규정을 준수한다고 판단하여 분석 대상에서 제외될 가능성도 존재한다.\n","date":"07 Oct, 2024","image":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003cpicture\u003e\n  \u003csource srcset=\"/images/article02/main_new_hu616324938516245409.webp\" media=\"(max-width: 575px)\"\u003e\n  \u003csource srcset=\"/images/article02/main_new_hu4275323508162782497.webp\" media=\"(max-width: 767px)\"\u003e\n  \u003csource srcset=\"/images/article02/main_new_hu15810271750831524829.webp\" media=\"(max-width: 991px)\"\u003e\n  \u003csource srcset=\"/images/article02/main_new_hu11163755585090871017.webp\"\u003e\n  \u003cimg loading=\"lazy\" decoding=\"async\" class=\"w-100 img-fluid rounded\" src=\"/images/article02/main_new_hu4950329311532694567.jpg\" alt=\"\" width=\"1850\" height=\"950\"\u003e\n\u003c/picture\u003e\n \n \n \n\n","permalink":"https://dodaeche.github.io/blog/article02/article/","tags":["Fake MTS","투자업체사칭"],"title":"허위 MTS 앱 분석 리포트"},{"categories":null,"contents":"2024년 2월 이후로 부고장 유형의 악성 앱이 지속적으로 탐지되지 않도록 고도화되고 있는 것으로 확인되고 있다. 현재 유포되고 있는 악성 앱은 1부에서 분석된 악성 앱과 동일한 유형이지만 악성 행위 분석 방지 목적으로 newobfs[1]가 적용된 부분과 별도의 DEX 파일을 동적 로딩하는 차이점이 존재한다. 이번 분석 대상 앱은 ‘부고장 알림 서비스’라는 이름으로 유포되고 있었으며 24년 3월 27일에 발견되었다.\n분석 악성 앱 해시 비교 최근 유포되는 부고장 유형의 악성 앱은 동일한 URL을 통해 APK 파일이 유포되고 있지만, 다운로드 된 APK 파일을 확인한 결과 [그림 1]과 같이 APK 파일의 인증서와 MD5 해시 값이 모두 다른 파일임을 확인하였다.\n[그림 1] 다운로드 시 변경되는 MD5 값과 인증서 SHA-1 값\n동일 URL에서 다운로드 받은 악성 앱 APK 파일의 resources.arsc 파일, res 디렉토리 일부 파일, 인증서 파일이 위치하는 META-INF 디렉토리 해시 값이 변경되었으며 그 외 다른 부분은 동일한 것으로 확인되었다.\n[그림 2] META-INF 폴더, res 폴더, resources.arsc 제거 후 해시(MD5) 값 비교\nDEX 분석 newobfs가 적용된 APK 파일은 악성 행위를 수행하는 DEX 파일이 o~bf 형태의 이름을 가지고 있는 것으로 확인되었으며, 앱 실행 시 해당 파일들은 [그림 4] 처럼 /data/data/[패키지 명]/newobfs/ 경로에 o~bf 형식의 파일 개수 만큼 복사되고 헤더와 파일명이 변경되어 pobfs 파일로 저장된다.\n[그림 3] o~bf 파일을 pobfs 파일로 변경하는 코드\n[그림 4] o~bf 파일의 개수만큼 생성된 pobfs 파일\n[그림 5] 앱 실행 시 헤더가 변경 된 o~bf 파일\npobfs 파일은 분석 결과 악성 행위 코드가 포함된 DEX 파일로 확인되었으며 해당 파일은 앱 실행 시 동적 로딩된다.\n[그림 6] pobfs 코드 확인(문자 정보 탈취)\n문자열 인코딩 [그림 8]과 같이 유출지 서버로 전송할 유출 대상의 데이터가 없을 경우 소스코드에 인코딩 처리되어 있는 문자열을 디코딩 후 전송하는 것으로 확인된다.\n[그림 7] 디코딩 코드\n[그림 8] 탈취할 연락처가 없을 시 동작 코드\n[그림 9] 문자열 디코딩\n분석 결과 분석 대상 ‘부고장 알림 서비스’ 앱은 [그림 10]과 같이 기 분석된 악성 앱과 유사한 악성 행위를 하고 있지만, DEX 파일의 동적 로딩 구성과 유출지, MQTT Broker 주소가 변경된 것으로 확인된다.\n[그림 10] 유사앱 기능 비교 표\n살펴본 바와 같이 악성 앱이 분석 방해 및 탐지 회피 목적을 위한 다양한 코드 보호 기법을 적용하고 있으며 이러한 추세는 앞으로도 지속될 것으로 예상된다.\n[그림 11] 지속적으로 고도화 되어가는 부고장 유형 악성 앱\n참고 자료 [1] Có gì bên trong mã độc Android đánh cắp tiền ngân hàng tại Việt Nam\n","date":"07 Oct, 2024","image":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003cpicture\u003e\n  \u003csource srcset=\"/images/article01/main_new_hu1517039123856996459.webp\" media=\"(max-width: 575px)\"\u003e\n  \u003csource srcset=\"/images/article01/main_new_hu5380173670713310275.webp\" media=\"(max-width: 767px)\"\u003e\n  \u003csource srcset=\"/images/article01/main_new_hu4886741816606776679.webp\" media=\"(max-width: 991px)\"\u003e\n  \u003csource srcset=\"/images/article01/main_new_hu1690446356323185040.webp\"\u003e\n  \u003cimg loading=\"lazy\" decoding=\"async\" class=\"w-100 img-fluid rounded\" src=\"/images/article01/main_new_hu77066466506368002.jpg\" alt=\"\" width=\"1850\" height=\"950\"\u003e\n\u003c/picture\u003e\n \n \n \n\n","permalink":"https://dodaeche.github.io/blog/article01/article/","tags":["부고장"],"title":"신규 유형 부고장 앱 분석 리포트"},{"categories":null,"contents":"동해 물과 백두산이 마르고 닳도록 하느님이 보우하사 우리나라 만세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세 남산 위에 저 소나무, 철갑을 두른 듯 바람서리 불변함은 우리 기상일세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세\nmalware apk vulnerability Python was created in the early 1990s by Guido van Rossum at Stichting Mathematisch Centrum (CWI, see https://www.cwi.nl) in the Netherlands as a successor of a language called ABC. Guido remains Python\u0026rsquo;s principal author, although it includes many contributions from others.\n","date":"06 Oct, 2024","image":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003cpicture\u003e\n  \u003csource srcset=\"/images/article00/main_new_hu6248676321072326358.webp\" media=\"(max-width: 575px)\"\u003e\n  \u003csource srcset=\"/images/article00/main_new_hu18104597990200697265.webp\" media=\"(max-width: 767px)\"\u003e\n  \u003csource srcset=\"/images/article00/main_new_hu14314356861431785531.webp\" media=\"(max-width: 991px)\"\u003e\n  \u003csource srcset=\"/images/article00/main_new_hu4244805182697785256.webp\"\u003e\n  \u003cimg loading=\"lazy\" decoding=\"async\" class=\"w-100 img-fluid rounded\" src=\"/images/article00/main_new_hu18133944831641024705.jpg\" alt=\"\" width=\"1850\" height=\"950\"\u003e\n\u003c/picture\u003e\n \n \n \n\n","permalink":"https://dodaeche.github.io/blog/article00/article00/","tags":["Malware","Android"],"title":"Test"}]